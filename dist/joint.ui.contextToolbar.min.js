/*! Rappid v3.1.1 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2020-06-11 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(t,i,s){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i;var o=s.mvc.View.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){s.util.bindAll(this,"onDocumentPointerdown")},render:function(){var t=this.options,o=this.constructor;return o.opened&&o.close(),t.autoClose&&setTimeout(this.delegateAutoCloseEvents.bind(this),0),t.type&&this.$el.attr("data-type",t.type),this.$el.toggleClass("joint-vertical",!!t.vertical),this.getRoot().append(this.$el),this.renderContent(),this.position(),o.opened=this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},renderContent:function(){var n=i("<div/>",{class:"tools"});this.options.tools&&s.util.toArray(this.options.tools).forEach(function(t){var o;o=t.icon?i("<img/>",{src:t.icon}):t.content;var e=i("<button/>",{class:"tool",html:o,"data-action":t.action});t.attrs&&e.attr(t.attrs),n.append(e)}),this.$el.append(n)},getRoot:function(){return i(this.options.root||document.documentElement)},position:function(){var t=s.util.getElementBBox(this.options.target),o=s.util.getElementBBox(this.getRoot()),e=this.$el.outerWidth(),n=t.x+t.width/2-e/2,i=t.y+t.height+this.options.padding;n-=o.x,i-=o.y,this.$el.css({left:n,top:i})},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){var o=i(t.currentTarget).attr("data-action");o&&this.trigger("action:"+o,t)},onDocumentPointerdown:function(t){var o=this.options.target,e=t.target;this.el.contains(e)||o.contains(e)||o===e||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){this.opened&&(this.opened.remove(),this.opened=void 0)},update:function(){this.opened&&this.opened.position()}});t.ContextToolbar=o}(this.joint.ui=this.joint.ui||{},$,joint);