/*! Rappid v3.1.1 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2015 client IO

 2020-06-11 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


this.joint=this.joint||{},function(t,r,e){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r;function n(){e.util.bindAll(this,"handleKey"),this.parser=new s,this.enable()}e.util.assign(n.prototype,r.Events),n.prototype.on=function(t,e,n){return r.Events.on.call(this,this.normalizeEvent(t),e,n),this},n.prototype.off=function(t,e,n){var i=t?this.normalizeEvent(t):null;return r.Events.off.call(this,i,e,n),this},n.prototype.normalizeEvent=function(t){if("object"!=typeof t)return this.normalizeShortcut(t);for(var e=Object.keys(t),n={},i=0,r=e.length;i<r;i++){var o=e[i];n[this.normalizeEvent(o)]=t[o]}return n},n.prototype.normalizeShortcut=function(t){if("all"===t.toLowerCase())return t;for(var e=this.parser.toEventObjectList(t),n=[],i=0;i<e.length;i++)n.push(this.hash(e[i]));return n.join(" ")},n.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))},n.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))},n.prototype.isActive=function(t,e){return this.isModifierActive(t,e)},n.prototype.isModifierActive=function(t,e){for(var n=this.parser.toEventObjectList(t),i=0;i<n.length;i++)if(n[i].modifiersCompare(e))return!0;return!1},n.prototype.hash=function(t){function e(t){return t?1:0}return[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)].join("")},n.prototype.handleKey=function(t){if(!this.isUnsupportedElement(t)){var e=y.fromNative(t);r.Events.trigger.call(this,this.hash(e),t)}},n.prototype.isUnsupportedElement=function(t){var e=t.target||t.srcElement;if(e){var n=e.tagName.toUpperCase();return"INPUT"===n||"SELECT"===n||"TEXTAREA"===n||e.isContentEditable}return!1};var s=function(){};s.prototype={constructor:s,parseEventString:function(t){var e,n,i=(t=t||"").split("+"),r=new y(0);for(n=0;n<i.length;n++){e=i[n];var o=this.getModifierPropertyName(e);o&&(r[o]=!0),1!==i.length&&void 0!==o||(r.which=s.getCode(e))}return r},toEventObjectList:function(t){return t.replace(/\s*\+\s*/gi,"+").split(" ").map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),n=c.KEYDOWN,i=e[0];if(1<e.length&&(i=e[1],n=e[0]),-1===p.indexOf(n))throw t+": invalid shortcut definition";var r=this.parseEventString(i);return n===c.KEYUP&&o[r.which]&&(r[o[r.which]]=!1),r.setType(n)},getModifierPropertyName:function(t){var e=i[t];return o[e]}},s.getCode=function(t){return h[t]||t.toUpperCase().charCodeAt(0)};var i={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91,meta:91},o={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},a={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},h={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123};e.util.assign(n,{keyMap:h,modifierMap:o,modifiers:i,charCodeAlternatives:a});var c={KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"},p=[c.KEYPRESS,c.KEYDOWN,c.KEYUP],y=function(t,e,n,i,r,o){this.which=t,this.shiftKey=e||!1,this.ctrlKey=n||!1,this.altKey=i||!1,this.metaKey=r||!1,this.type=o||c.KEYDOWN};y.fromNative=function(t){var e=t.which;t.type===c.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),a[e]&&(e=s.getCode(a[e]));var n=new y(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type);return t.type===c.KEYUP&&o[e]&&(n[o[e]]=!1),n},y.prototype.modifiersCompare=function(t){return!(this.shiftKey&&this.shiftKey!==t.shiftKey||this.ctrlKey&&this.ctrlKey!==t.ctrlKey||this.altKey&&this.altKey!==t.altKey||this.metaKey&&this.metaKey!==t.metaKey)},y.prototype.setType=function(t){return this.type=t,this},t.Keyboard=n}(this.joint.ui=this.joint.ui||{},Backbone,joint);